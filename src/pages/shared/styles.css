/**
 * D365 CE Fluent UI Page Styles
 * Modern design system matching Dynamics 365 Customer Engagement
 */

/* CSS Variables - D365 Design Tokens */
:root {
  /* Brand Colors */
  --d365-brand-primary: #0078d4;
  --d365-brand-primary-hover: #106ebe;
  --d365-brand-primary-pressed: #005a9e;

  /* Neutral Colors */
  --d365-neutral-background: #f5f5f5;
  --d365-neutral-background-card: #ffffff;
  --d365-neutral-foreground: #242424;
  --d365-neutral-foreground-secondary: #616161;
  --d365-neutral-foreground-disabled: #a19f9d;
  --d365-neutral-stroke: #d1d1d1;
  --d365-neutral-stroke-subtle: #e0e0e0;

  /* Status Colors */
  --d365-success: #107c10;
  --d365-success-bg: #dff6dd;
  --d365-warning: #797600;
  --d365-warning-bg: #fff4ce;
  --d365-error: #a4262c;
  --d365-error-bg: #fde7e9;
  --d365-info: #0078d4;
  --d365-info-bg: #deecf9;

  /* Shadows */
  --d365-shadow-2: 0 1px 2px rgba(0,0,0,0.12);
  --d365-shadow-4: 0 2px 4px rgba(0,0,0,0.14);
  --d365-shadow-8: 0 4px 8px rgba(0,0,0,0.14);
  --d365-shadow-16: 0 8px 16px rgba(0,0,0,0.14);

  /* Spacing */
  --d365-spacing-xs: 4px;
  --d365-spacing-s: 8px;
  --d365-spacing-m: 12px;
  --d365-spacing-l: 16px;
  --d365-spacing-xl: 20px;
  --d365-spacing-xxl: 24px;

  /* Border Radius */
  --d365-radius-s: 4px;
  --d365-radius-m: 8px;
  --d365-radius-l: 12px;

  /* Typography */
  --d365-font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif;
  --d365-font-size-xs: 10px;
  --d365-font-size-s: 12px;
  --d365-font-size-m: 14px;
  --d365-font-size-l: 16px;
  --d365-font-size-xl: 20px;
  --d365-font-size-xxl: 24px;
  --d365-font-size-hero: 28px;

  /* Layout */
  --d365-header-height: 48px;
  --d365-nav-width: 220px;
  --d365-content-max-width: 1400px;
}

/* Reset & Base */
*, *::before, *::after {
  box-sizing: border-box;
}

html, body {
  margin: 0;
  padding: 0;
  font-family: var(--d365-font-family);
  font-size: var(--d365-font-size-m);
  color: var(--d365-neutral-foreground);
  background: var(--d365-neutral-background);
  line-height: 1.5;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* App Shell */
.d365-app {
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}

/* Header / Command Bar */
.d365-header {
  display: flex;
  align-items: center;
  height: var(--d365-header-height);
  background: var(--d365-neutral-background-card);
  border-bottom: 1px solid var(--d365-neutral-stroke-subtle);
  padding: 0 var(--d365-spacing-l);
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: var(--d365-shadow-2);
}

.d365-header__logo {
  display: flex;
  align-items: center;
  gap: var(--d365-spacing-m);
  font-weight: 600;
  font-size: var(--d365-font-size-l);
  color: var(--d365-neutral-foreground);
  text-decoration: none;
}

.d365-header__logo-icon {
  width: 28px;
  height: 28px;
  border-radius: var(--d365-radius-s);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 700;
  font-size: var(--d365-font-size-s);
}

.d365-header__nav {
  display: flex;
  align-items: center;
  gap: var(--d365-spacing-xs);
  margin-left: var(--d365-spacing-xxl);
}

.d365-header__nav-item {
  padding: var(--d365-spacing-s) var(--d365-spacing-m);
  border-radius: var(--d365-radius-s);
  color: var(--d365-neutral-foreground-secondary);
  text-decoration: none;
  font-size: var(--d365-font-size-m);
  font-weight: 500;
  transition: all 0.15s ease;
}

.d365-header__nav-item:hover {
  background: var(--d365-neutral-stroke-subtle);
  color: var(--d365-neutral-foreground);
}

.d365-header__nav-item--active {
  background: var(--d365-info-bg);
  color: var(--d365-brand-primary);
}

.d365-header__actions {
  margin-left: auto;
  display: flex;
  align-items: center;
  gap: var(--d365-spacing-s);
}

/* Main Content Area - Embedded in D365 MDA (no left padding needed) */
.d365-main {
  flex: 1;
  padding: var(--d365-spacing-l) var(--d365-spacing-xl);
  width: 100%;
}

/* Page Title */
.d365-page-title {
  margin: 0 0 var(--d365-spacing-l) 0;
}

.d365-page-title__heading {
  font-size: var(--d365-font-size-hero);
  font-weight: 600;
  margin: 0 0 var(--d365-spacing-s) 0;
  color: var(--d365-neutral-foreground);
}

.d365-page-title__subtitle {
  font-size: var(--d365-font-size-m);
  color: var(--d365-neutral-foreground-secondary);
  margin: 0;
}

/* Cards */
.d365-card {
  background: var(--d365-neutral-background-card);
  border-radius: var(--d365-radius-m);
  box-shadow: var(--d365-shadow-4);
  overflow: hidden;
}

.d365-card__header {
  padding: var(--d365-spacing-l) var(--d365-spacing-xl);
  border-bottom: 1px solid var(--d365-neutral-stroke-subtle);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.d365-card__title {
  font-size: var(--d365-font-size-l);
  font-weight: 600;
  margin: 0;
  display: flex;
  align-items: center;
  gap: var(--d365-spacing-s);
}

.d365-card__badge {
  display: inline-flex;
  align-items: center;
  padding: 2px 8px;
  border-radius: 10px;
  font-size: var(--d365-font-size-xs);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.d365-card__badge--ready {
  background: var(--d365-success-bg);
  color: var(--d365-success);
}

.d365-card__badge--beta {
  background: var(--d365-warning-bg);
  color: var(--d365-warning);
}

.d365-card__body {
  padding: var(--d365-spacing-xl);
}

.d365-card__description {
  color: var(--d365-neutral-foreground-secondary);
  margin: 0 0 var(--d365-spacing-l) 0;
  font-size: var(--d365-font-size-m);
}

/* Card Grid Layout - Vertical list format for D365 embedded pages */
.d365-card-grid {
  display: flex;
  flex-direction: column;
  gap: var(--d365-spacing-l);
}

/* Buttons */
.d365-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--d365-spacing-s);
  padding: var(--d365-spacing-s) var(--d365-spacing-l);
  border: 1px solid transparent;
  border-radius: var(--d365-radius-s);
  font-family: var(--d365-font-family);
  font-size: var(--d365-font-size-m);
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s ease;
  text-decoration: none;
  min-height: 32px;
}

.d365-btn:focus-visible {
  outline: 2px solid var(--d365-brand-primary);
  outline-offset: 2px;
}

.d365-btn--primary {
  background: var(--d365-brand-primary);
  color: white;
}

.d365-btn--primary:hover {
  background: var(--d365-brand-primary-hover);
}

.d365-btn--primary:active {
  background: var(--d365-brand-primary-pressed);
}

.d365-btn--secondary {
  background: transparent;
  border-color: var(--d365-neutral-stroke);
  color: var(--d365-neutral-foreground);
}

.d365-btn--secondary:hover {
  background: var(--d365-neutral-stroke-subtle);
}

.d365-btn--success {
  background: var(--d365-success);
  color: white;
}

.d365-btn--success:hover {
  background: #0e6b0e;
}

.d365-btn--warning {
  background: #ffc107;
  color: #1a1a1a;
}

.d365-btn--warning:hover {
  background: #e0a800;
}

.d365-btn--error {
  background: var(--d365-error);
  color: white;
}

.d365-btn--error:hover {
  background: #8a2024;
}

.d365-btn--ghost {
  background: transparent;
  color: var(--d365-brand-primary);
}

.d365-btn--ghost:hover {
  background: var(--d365-info-bg);
}

.d365-btn--small {
  padding: var(--d365-spacing-xs) var(--d365-spacing-m);
  font-size: var(--d365-font-size-s);
  min-height: 28px;
}

/* Button Groups */
.d365-btn-group {
  display: flex;
  flex-wrap: wrap;
  gap: var(--d365-spacing-s);
}

/* Section Dividers */
.d365-section {
  margin-bottom: var(--d365-spacing-l);
}

.d365-section__title {
  font-size: var(--d365-font-size-m);
  font-weight: 600;
  color: var(--d365-neutral-foreground);
  margin: 0 0 var(--d365-spacing-m) 0;
}

/* Code Blocks - Card style using Fluent UI tokens */
.d365-code {
  background: var(--colorNeutralBackground3, #f5f5f5);
  border-radius: var(--borderRadiusMedium, 4px);
  padding: var(--spacingVerticalM, 12px) var(--spacingHorizontalM, 12px);
  font-family: 'Cascadia Code', 'Fira Code', 'Consolas', monospace;
  font-size: var(--fontSizeBase200, 12px);
  color: var(--colorNeutralForeground1, #242424);
  overflow-x: auto;
  line-height: 1.6;
  box-shadow: var(--shadow4, 0 2px 4px rgba(0,0,0,0.14));
  border: 1px solid var(--colorNeutralStroke1, #d1d1d1);
}

.d365-code--inline {
  display: inline;
  padding: 2px 6px;
  background: var(--d365-neutral-stroke-subtle);
  color: var(--d365-neutral-foreground);
  border-radius: 3px;
}

/* Info/Note Boxes */
.d365-note {
  display: flex;
  gap: var(--d365-spacing-m);
  padding: var(--d365-spacing-m) var(--d365-spacing-l);
  border-radius: var(--d365-radius-s);
  font-size: var(--d365-font-size-m);
  margin: var(--d365-spacing-l) 0;
}

.d365-note--info {
  background: var(--d365-info-bg);
  border-left: 3px solid var(--d365-info);
  color: #004578;
}

.d365-note--warning {
  background: var(--d365-warning-bg);
  border-left: 3px solid #ffc107;
  color: var(--d365-warning);
}

.d365-note--success {
  background: var(--d365-success-bg);
  border-left: 3px solid var(--d365-success);
  color: #0b5c0b;
}

.d365-note--error {
  background: var(--d365-error-bg);
  border-left: 3px solid var(--d365-error);
  color: #6e1517;
}

.d365-note__icon {
  flex-shrink: 0;
  font-size: var(--d365-font-size-l);
}

/* Test Results Console */
.d365-console {
  background: #1e1e1e;
  border-radius: var(--d365-radius-s);
  padding: var(--d365-spacing-m);
  font-family: 'Cascadia Code', 'Consolas', monospace;
  font-size: var(--d365-font-size-s);
  max-height: 200px;
  overflow-y: auto;
  margin-top: var(--d365-spacing-l);
}

.d365-console:empty::before {
  content: 'Results will appear here...';
  color: #6a6a6a;
}

.d365-console__line {
  padding: 2px 0;
  display: flex;
  gap: var(--d365-spacing-s);
}

.d365-console__line--success {
  color: #4ec9b0;
}

.d365-console__line--error {
  color: #f14c4c;
}

.d365-console__line--warning {
  color: #cca700;
}

.d365-console__line--info {
  color: #3794ff;
}

.d365-console__time {
  color: #6a6a6a;
}

/* Grid for Test Buttons */
.d365-test-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: var(--d365-spacing-s);
}

/* Footer */
.d365-footer {
  padding: var(--d365-spacing-xxl);
  text-align: center;
  color: var(--d365-neutral-foreground-secondary);
  font-size: var(--d365-font-size-s);
  border-top: 1px solid var(--d365-neutral-stroke-subtle);
  background: var(--d365-neutral-background-card);
  margin-top: auto;
}

.d365-footer__links {
  display: flex;
  justify-content: center;
  gap: var(--d365-spacing-xl);
  margin-top: var(--d365-spacing-m);
}

.d365-footer__link {
  color: var(--d365-brand-primary);
  text-decoration: none;
}

.d365-footer__link:hover {
  text-decoration: underline;
}

/* Version Badge */
.d365-version {
  display: inline-flex;
  align-items: center;
  padding: 2px 8px;
  background: var(--d365-neutral-stroke-subtle);
  border-radius: 10px;
  font-size: var(--d365-font-size-xs);
  font-weight: 500;
  color: var(--d365-neutral-foreground-secondary);
  margin-left: var(--d365-spacing-s);
}

/* Documentation Content - Native D365 styling */
.d365-docs {
  background: transparent;
  padding: 0;
  line-height: 1.6;
  color: var(--d365-neutral-foreground);
}

.d365-docs h1 {
  font-size: var(--d365-font-size-xl);
  font-weight: 600;
  margin: 0 0 var(--d365-spacing-l) 0;
  color: var(--d365-neutral-foreground);
}

.d365-docs h2 {
  font-size: var(--d365-font-size-l);
  font-weight: 600;
  margin: var(--d365-spacing-xl) 0 var(--d365-spacing-m) 0;
  color: var(--d365-neutral-foreground);
}

.d365-docs h3 {
  font-size: var(--d365-font-size-m);
  font-weight: 600;
  margin: var(--d365-spacing-l) 0 var(--d365-spacing-s) 0;
  color: var(--d365-neutral-foreground);
}

.d365-docs p {
  margin: 0 0 var(--d365-spacing-m) 0;
}

.d365-docs ul, .d365-docs ol {
  margin: 0 0 var(--d365-spacing-m) 0;
  padding-left: var(--d365-spacing-xl);
}

.d365-docs li {
  margin-bottom: var(--d365-spacing-xs);
}

.d365-docs pre {
  background: var(--colorNeutralBackground3, #f5f5f5);
  border-radius: var(--borderRadiusMedium, 4px);
  padding: var(--spacingVerticalM, 12px) var(--spacingHorizontalM, 12px);
  font-family: 'Cascadia Code', 'Fira Code', 'Consolas', monospace;
  font-size: var(--fontSizeBase200, 12px);
  color: var(--colorNeutralForeground1, #242424);
  overflow-x: auto;
  line-height: 1.6;
  box-shadow: var(--shadow4, 0 2px 4px rgba(0,0,0,0.14));
  border: 1px solid var(--colorNeutralStroke1, #d1d1d1);
  margin: var(--spacingVerticalL, 16px) 0;
}

.d365-docs pre code {
  background: transparent;
  padding: 0;
  font-size: inherit;
  color: inherit;
}

.d365-docs code:not(pre code) {
  background: var(--colorNeutralBackground3, #f5f5f5);
  padding: 2px 6px;
  border-radius: var(--borderRadiusSmall, 2px);
  font-size: var(--fontSizeBase200, 12px);
  font-family: 'Cascadia Code', 'Consolas', monospace;
  border: 1px solid var(--colorNeutralStroke2, #e0e0e0);
}

.d365-docs a {
  color: var(--d365-brand-primary);
  text-decoration: none;
}

.d365-docs a:hover {
  text-decoration: underline;
}

.d365-docs table {
  width: 100%;
  border-collapse: collapse;
  margin: var(--d365-spacing-m) 0;
  font-size: var(--d365-font-size-m);
}

.d365-docs th, .d365-docs td {
  padding: var(--d365-spacing-s) var(--d365-spacing-m);
  text-align: left;
  border: 1px solid var(--d365-neutral-stroke-subtle);
}

.d365-docs th {
  font-weight: 600;
  background: var(--d365-neutral-background);
}

.d365-docs hr {
  border: none;
  border-top: 1px solid var(--d365-neutral-stroke-subtle);
  margin: var(--d365-spacing-l) 0;
}

/* Loading State */
.d365-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: calc(var(--d365-spacing-xxl) * 2);
  color: var(--d365-neutral-foreground-secondary);
}

.d365-loading__spinner {
  width: 32px;
  height: 32px;
  border: 3px solid var(--d365-neutral-stroke-subtle);
  border-top-color: var(--d365-brand-primary);
  border-radius: 50%;
  animation: d365-spin 0.8s linear infinite;
  margin-right: var(--d365-spacing-m);
}

@keyframes d365-spin {
  to { transform: rotate(360deg); }
}

/* Scrollbar Styling */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--d365-neutral-stroke-subtle);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: var(--d365-neutral-stroke);
  border-radius: 4px;
}

/* Tabs */
.d365-tabs {
  display: flex;
  gap: var(--d365-spacing-s);
  padding: var(--d365-spacing-l);
  background: var(--d365-neutral-background-card);
  border-bottom: 1px solid var(--d365-neutral-stroke-subtle);
  overflow-x: auto;
}

.d365-tab {
  display: flex;
  align-items: center;
  gap: var(--d365-spacing-s);
  padding: var(--d365-spacing-m) var(--d365-spacing-l);
  background: transparent;
  border: none;
  border-bottom: 2px solid transparent;
  color: var(--d365-neutral-foreground-secondary);
  font-family: var(--d365-font-family);
  font-size: var(--d365-font-size-m);
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  white-space: nowrap;
}

.d365-tab:hover {
  color: var(--d365-neutral-foreground);
  background: var(--d365-neutral-background);
}

.d365-tab--active {
  color: var(--d365-brand-primary);
  border-bottom-color: var(--d365-brand-primary);
}

.d365-tab__icon {
  font-size: var(--d365-font-size-l);
}

.d365-tab__label {
  font-size: var(--d365-font-size-m);
}

.d365-tab-content {
  flex: 1;
}

/* Hide nested Layout headers/footers when inside tab content */
.d365-tab-content .d365-header,
.d365-tab-content .d365-footer {
  display: none;
}

/* Make nested Layout main fill the space */
.d365-tab-content .d365-main {
  padding: 0;
}

/* Make nested app containers behave as content only */
.d365-tab-content .d365-app {
  display: block;
  min-height: auto;
}

::-webkit-scrollbar-thumb:hover {
  background: #b0b0b0;
}

/* Focus visible for accessibility */
:focus-visible {
  outline: 2px solid var(--d365-brand-primary);
  outline-offset: 2px;
}

/* Hide focus ring for mouse users */
:focus:not(:focus-visible) {
  outline: none;
}
